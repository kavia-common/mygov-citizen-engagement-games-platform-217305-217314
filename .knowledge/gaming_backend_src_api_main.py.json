{"is_source_file": true, "format": "Python", "description": "This is a source code file for a FastAPI-based backend API for the MyGov Citizen Engagement Gaming Platform. It defines the main application setup, database connection management, health check endpoints, and includes routers for auth and user-related routes.", "external_files": ["src/api/routes/auth", "src/api/routes/users", "db"], "external_methods": ["db_module.create_connection", "db_module.DatabaseConfigError"], "published": ["app", "health_check", "service_status", "get_db_conn", "on_startup", "on_shutdown"], "classes": [{"name": "HealthResponse", "description": "Pydantic model representing the health check response with overall status, database status, and additional details."}], "methods": [{"name": "sqlite3.Connection get_db_conn()", "description": "Provides a database connection, raises HTTP 503 if connection is not configured or available.", "scope": "", "scopeKind": ""}, {"name": "None on_startup()", "description": "Initializes the database connection when the application starts.", "scope": "", "scopeKind": ""}, {"name": "None on_shutdown()", "description": "Closes the database connection during app shutdown.", "scope": "", "scopeKind": ""}, {"name": "HealthResponse health_check(db: sqlite3.Connection = Depends(get_db_conn))", "description": "Endpoint to perform a health check, verifies database connectivity and foreign key status.", "scope": "", "scopeKind": ""}, {"name": "JSONResponse service_status()", "description": "A lightweight endpoint indicating if the database connection is initialized, without requiring database access.", "scope": "", "scopeKind": ""}], "calls": ["db_module.create_connection", "db_module.DatabaseConfigError", "db.cursor", "cur.execute", "cur.fetchone", "cur.close", "raise HTTPException", "FastAPI.include_router"], "search-terms": ["FastAPI app setup", "Health check endpoint", "Database connection management", "SQLite3 dependency", "CORS middleware", "FastAPI event handlers", "API route registration", "HealthResponse model", "Dependency injection in FastAPI"], "state": 2, "file_id": 2, "knowledge_revision": 22, "git_revision": "ead6510d46b957004c345f43de9c69c9c0a6d401", "revision_history": [{"7": "e100e959f259d21122bf9eb25506196ece8c2bf0"}, {"12": "e100e959f259d21122bf9eb25506196ece8c2bf0"}, {"13": "e100e959f259d21122bf9eb25506196ece8c2bf0"}, {"14": "e100e959f259d21122bf9eb25506196ece8c2bf0"}, {"15": "57177fa216712bb08275bed0c7bf5c25bb0bad4a"}, {"22": "ead6510d46b957004c345f43de9c69c9c0a6d401"}], "ctags": [{"_type": "tag", "name": "HealthResponse", "path": "/home/kavia/workspace/code-generation/mygov-citizen-engagement-games-platform-217305-217314/gaming_backend/src/api/main.py", "pattern": "/^class HealthResponse(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "_db_conn", "path": "/home/kavia/workspace/code-generation/mygov-citizen-engagement-games-platform-217305-217314/gaming_backend/src/api/main.py", "pattern": "/^_db_conn: Optional[sqlite3.Connection] = None$/", "language": "Python", "typeref": "typename:Optional[sqlite3.Connection]", "kind": "variable"}, {"_type": "tag", "name": "app", "path": "/home/kavia/workspace/code-generation/mygov-citizen-engagement-games-platform-217305-217314/gaming_backend/src/api/main.py", "pattern": "/^app = FastAPI($/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "auth_router", "path": "/home/kavia/workspace/code-generation/mygov-citizen-engagement-games-platform-217305-217314/gaming_backend/src/api/main.py", "pattern": "/^from src.api.routes.auth import router as auth_router  # noqa: E402$/", "language": "Python", "kind": "unknown", "nameref": "unknown:router"}, {"_type": "tag", "name": "database", "path": "/home/kavia/workspace/code-generation/mygov-citizen-engagement-games-platform-217305-217314/gaming_backend/src/api/main.py", "pattern": "/^    database: str = Field(..., description=\"Database connectivity status.\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "HealthResponse", "scopeKind": "class"}, {"_type": "tag", "name": "db_module", "path": "/home/kavia/workspace/code-generation/mygov-citizen-engagement-games-platform-217305-217314/gaming_backend/src/api/main.py", "pattern": "/^from . import db as db_module$/", "language": "Python", "kind": "unknown", "nameref": "unknown:db"}, {"_type": "tag", "name": "detail", "path": "/home/kavia/workspace/code-generation/mygov-citizen-engagement-games-platform-217305-217314/gaming_backend/src/api/main.py", "pattern": "/^    detail: str = Field(..., description=\"Additional details about the service.\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "HealthResponse", "scopeKind": "class"}, {"_type": "tag", "name": "get_db_conn", "path": "/home/kavia/workspace/code-generation/mygov-citizen-engagement-games-platform-217305-217314/gaming_backend/src/api/main.py", "pattern": "/^def get_db_conn() -> sqlite3.Connection:$/", "language": "Python", "typeref": "typename:sqlite3.Connection", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "health_check", "path": "/home/kavia/workspace/code-generation/mygov-citizen-engagement-games-platform-217305-217314/gaming_backend/src/api/main.py", "pattern": "/^def health_check(db: sqlite3.Connection = Depends(get_db_conn)) -> HealthResponse:$/", "language": "Python", "typeref": "typename:HealthResponse", "kind": "function", "signature": "(db: sqlite3.Connection = Depends(get_db_conn))"}, {"_type": "tag", "name": "on_shutdown", "path": "/home/kavia/workspace/code-generation/mygov-citizen-engagement-games-platform-217305-217314/gaming_backend/src/api/main.py", "pattern": "/^def on_shutdown() -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "on_startup", "path": "/home/kavia/workspace/code-generation/mygov-citizen-engagement-games-platform-217305-217314/gaming_backend/src/api/main.py", "pattern": "/^def on_startup() -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "service_status", "path": "/home/kavia/workspace/code-generation/mygov-citizen-engagement-games-platform-217305-217314/gaming_backend/src/api/main.py", "pattern": "/^def service_status() -> JSONResponse:$/", "language": "Python", "typeref": "typename:JSONResponse", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "status", "path": "/home/kavia/workspace/code-generation/mygov-citizen-engagement-games-platform-217305-217314/gaming_backend/src/api/main.py", "pattern": "/^    status: str = Field(..., description=\"Overall service status.\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "HealthResponse", "scopeKind": "class"}, {"_type": "tag", "name": "users_router", "path": "/home/kavia/workspace/code-generation/mygov-citizen-engagement-games-platform-217305-217314/gaming_backend/src/api/main.py", "pattern": "/^from src.api.routes.users import router as users_router  # noqa: E402$/", "language": "Python", "kind": "unknown", "nameref": "unknown:router"}], "hash": "c1e69e9207e61a4555f69b54aa363c41", "format-version": 4, "code-base-name": "gaming_backend", "filename": "gaming_backend/src/api/main.py", "fields": [{"name": "Optional[sqlite3.Connection] _db_conn", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "app = FastAPI(", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "str database", "scope": "HealthResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "str detail", "scope": "HealthResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "str status", "scope": "HealthResponse", "scopeKind": "class", "description": "unavailable"}]}