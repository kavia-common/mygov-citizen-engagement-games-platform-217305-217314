{"is_source_file": true, "format": "Python", "description": "This is a main server file for a FastAPI application. It initializes the app, configures middleware, manages database connections, and defines health check endpoints. It also includes route registrations for authentication, users, and games modules.", "external_files": ["src/api/routes/auth.py", "src/api/routes/users.py", "src/api/routes/games.py", "src/api/db.py"], "external_methods": ["db_module.create_connection()", "db_module.DatabaseConfigError"], "published": ["app"], "classes": [{"name": "HealthResponse", "description": "Pydantic model representing the health check response, including status, database connectivity, and details."}], "methods": [{"name": "sqlite3.Connection get_db_conn()", "description": "Dependency provider to retrieve the current database connection, raising an HTTP 503 if not initialized.", "scope": "", "scopeKind": ""}, {"name": "None on_startup()", "description": "Initializes the database connection at application startup.", "scope": "", "scopeKind": ""}, {"name": "None on_shutdown()", "description": "Closes the database connection upon application shutdown.", "scope": "", "scopeKind": ""}, {"name": "HealthResponse health_check(db: sqlite3.Connection = Depends(get_db_conn))", "description": "Endpoint that performs a health check, verifying database connectivity and returning status information.", "scope": "", "scopeKind": ""}, {"name": "JSONResponse service_status()", "description": "Lightweight endpoint to check service status without requiring database access.", "scope": "", "scopeKind": ""}], "calls": ["db_module.create_connection()", "db_module.DatabaseConfigError", "db.cursor()", "cur.execute", "cur.fetchone()", "cur.close()", "app.include_router"], "search-terms": ["FastAPI health check", "SQLite database connection", "dependency injection", "app startup and shutdown", "API route registration"], "state": 2, "file_id": 2, "knowledge_revision": 26, "git_revision": "cd0dc9336d4ce838a7bfb4872116d8553d791a9a", "revision_history": [{"7": "e100e959f259d21122bf9eb25506196ece8c2bf0"}, {"12": "e100e959f259d21122bf9eb25506196ece8c2bf0"}, {"13": "e100e959f259d21122bf9eb25506196ece8c2bf0"}, {"14": "e100e959f259d21122bf9eb25506196ece8c2bf0"}, {"15": "57177fa216712bb08275bed0c7bf5c25bb0bad4a"}, {"22": "ead6510d46b957004c345f43de9c69c9c0a6d401"}, {"26": "cd0dc9336d4ce838a7bfb4872116d8553d791a9a"}], "ctags": [{"_type": "tag", "name": "HealthResponse", "path": "/home/kavia/workspace/code-generation/mygov-citizen-engagement-games-platform-217305-217314/gaming_backend/src/api/main.py", "pattern": "/^class HealthResponse(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "_db_conn", "path": "/home/kavia/workspace/code-generation/mygov-citizen-engagement-games-platform-217305-217314/gaming_backend/src/api/main.py", "pattern": "/^_db_conn: Optional[sqlite3.Connection] = None$/", "language": "Python", "typeref": "typename:Optional[sqlite3.Connection]", "kind": "variable"}, {"_type": "tag", "name": "app", "path": "/home/kavia/workspace/code-generation/mygov-citizen-engagement-games-platform-217305-217314/gaming_backend/src/api/main.py", "pattern": "/^app = FastAPI($/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "auth_router", "path": "/home/kavia/workspace/code-generation/mygov-citizen-engagement-games-platform-217305-217314/gaming_backend/src/api/main.py", "pattern": "/^from src.api.routes.auth import router as auth_router  # noqa: E402$/", "language": "Python", "kind": "unknown", "nameref": "unknown:router"}, {"_type": "tag", "name": "database", "path": "/home/kavia/workspace/code-generation/mygov-citizen-engagement-games-platform-217305-217314/gaming_backend/src/api/main.py", "pattern": "/^    database: str = Field(..., description=\"Database connectivity status.\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "HealthResponse", "scopeKind": "class"}, {"_type": "tag", "name": "db_module", "path": "/home/kavia/workspace/code-generation/mygov-citizen-engagement-games-platform-217305-217314/gaming_backend/src/api/main.py", "pattern": "/^from . import db as db_module$/", "language": "Python", "kind": "unknown", "nameref": "unknown:db"}, {"_type": "tag", "name": "detail", "path": "/home/kavia/workspace/code-generation/mygov-citizen-engagement-games-platform-217305-217314/gaming_backend/src/api/main.py", "pattern": "/^    detail: str = Field(..., description=\"Additional details about the service.\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "HealthResponse", "scopeKind": "class"}, {"_type": "tag", "name": "games_router", "path": "/home/kavia/workspace/code-generation/mygov-citizen-engagement-games-platform-217305-217314/gaming_backend/src/api/main.py", "pattern": "/^from src.api.routes.games import router as games_router  # noqa: E402$/", "language": "Python", "kind": "unknown", "nameref": "unknown:router"}, {"_type": "tag", "name": "get_db_conn", "path": "/home/kavia/workspace/code-generation/mygov-citizen-engagement-games-platform-217305-217314/gaming_backend/src/api/main.py", "pattern": "/^def get_db_conn() -> sqlite3.Connection:$/", "language": "Python", "typeref": "typename:sqlite3.Connection", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "health_check", "path": "/home/kavia/workspace/code-generation/mygov-citizen-engagement-games-platform-217305-217314/gaming_backend/src/api/main.py", "pattern": "/^def health_check(db: sqlite3.Connection = Depends(get_db_conn)) -> HealthResponse:$/", "language": "Python", "typeref": "typename:HealthResponse", "kind": "function", "signature": "(db: sqlite3.Connection = Depends(get_db_conn))"}, {"_type": "tag", "name": "on_shutdown", "path": "/home/kavia/workspace/code-generation/mygov-citizen-engagement-games-platform-217305-217314/gaming_backend/src/api/main.py", "pattern": "/^def on_shutdown() -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "on_startup", "path": "/home/kavia/workspace/code-generation/mygov-citizen-engagement-games-platform-217305-217314/gaming_backend/src/api/main.py", "pattern": "/^def on_startup() -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "service_status", "path": "/home/kavia/workspace/code-generation/mygov-citizen-engagement-games-platform-217305-217314/gaming_backend/src/api/main.py", "pattern": "/^def service_status() -> JSONResponse:$/", "language": "Python", "typeref": "typename:JSONResponse", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "status", "path": "/home/kavia/workspace/code-generation/mygov-citizen-engagement-games-platform-217305-217314/gaming_backend/src/api/main.py", "pattern": "/^    status: str = Field(..., description=\"Overall service status.\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "HealthResponse", "scopeKind": "class"}, {"_type": "tag", "name": "users_router", "path": "/home/kavia/workspace/code-generation/mygov-citizen-engagement-games-platform-217305-217314/gaming_backend/src/api/main.py", "pattern": "/^from src.api.routes.users import router as users_router  # noqa: E402$/", "language": "Python", "kind": "unknown", "nameref": "unknown:router"}], "hash": "7df1c651837e4c67e330248b067e5145", "format-version": 4, "code-base-name": "gaming_backend", "filename": "gaming_backend/src/api/main.py", "fields": [{"name": "Optional[sqlite3.Connection] _db_conn", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "app = FastAPI(", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "str database", "scope": "HealthResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "str detail", "scope": "HealthResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "str status", "scope": "HealthResponse", "scopeKind": "class", "description": "unavailable"}]}