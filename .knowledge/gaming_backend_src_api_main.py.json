{"is_source_file": true, "format": "Python", "description": "This source file defines a FastAPI backend application for the MyGov Citizen Engagement Gaming Platform. It sets up API endpoints for health checks, manages database connection lifecycle, and includes configuration for CORS middleware.", "external_files": ["from . import db as db_module"], "external_methods": ["db_module.create_connection()", "db_module.DatabaseConfigError"], "published": ["app"], "classes": [{"name": "HealthResponse", "description": "A Pydantic model representing the health status response containing overall status, database connectivity, and details."}], "methods": [{"name": "sqlite3.Connection get_db_conn()", "description": "Dependency function that provides an active SQLite database connection or raises an HTTP 503 if not available.", "scope": "", "scopeKind": ""}, {"name": "None on_startup()", "description": "Event handler to initialize the database connection when the application starts.", "scope": "", "scopeKind": ""}, {"name": "None on_shutdown()", "description": "Event handler to properly close the database connection when the application shuts down.", "scope": "", "scopeKind": ""}, {"name": "HealthResponse health_check(db: sqlite3.Connection = Depends(get_db_conn))", "description": "API endpoint that performs a health check, including a lightweight database FCA verification, and returns the health status.", "scope": "", "scopeKind": ""}, {"name": "JSONResponse service_status()", "description": "A lightweight endpoint providing the current service status without requiring database connectivity.", "scope": "", "scopeKind": ""}], "calls": ["db_module.create_connection()", "db_module.DatabaseConfigError", "db_connection.cursor()", "cursor.execute()", "cursor.fetchone()", "cursor.close()", "db_connection.close()"], "search-terms": ["FastAPI health check", "SQLite database connection management", "MyGov Citizen Engagement Gaming Platform backend", "API startup and shutdown events", "CORS middleware configuration", "HealthResponse model"], "state": 2, "file_id": 2, "knowledge_revision": 15, "git_revision": "57177fa216712bb08275bed0c7bf5c25bb0bad4a", "revision_history": [{"7": "e100e959f259d21122bf9eb25506196ece8c2bf0"}, {"12": "e100e959f259d21122bf9eb25506196ece8c2bf0"}, {"13": "e100e959f259d21122bf9eb25506196ece8c2bf0"}, {"14": "e100e959f259d21122bf9eb25506196ece8c2bf0"}, {"15": "57177fa216712bb08275bed0c7bf5c25bb0bad4a"}], "ctags": [{"_type": "tag", "name": "HealthResponse", "path": "/home/kavia/workspace/code-generation/mygov-citizen-engagement-games-platform-217305-217314/gaming_backend/src/api/main.py", "pattern": "/^class HealthResponse(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "_db_conn", "path": "/home/kavia/workspace/code-generation/mygov-citizen-engagement-games-platform-217305-217314/gaming_backend/src/api/main.py", "pattern": "/^_db_conn: Optional[sqlite3.Connection] = None$/", "language": "Python", "typeref": "typename:Optional[sqlite3.Connection]", "kind": "variable"}, {"_type": "tag", "name": "app", "path": "/home/kavia/workspace/code-generation/mygov-citizen-engagement-games-platform-217305-217314/gaming_backend/src/api/main.py", "pattern": "/^app = FastAPI($/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "database", "path": "/home/kavia/workspace/code-generation/mygov-citizen-engagement-games-platform-217305-217314/gaming_backend/src/api/main.py", "pattern": "/^    database: str = Field(..., description=\"Database connectivity status.\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "HealthResponse", "scopeKind": "class"}, {"_type": "tag", "name": "db_module", "path": "/home/kavia/workspace/code-generation/mygov-citizen-engagement-games-platform-217305-217314/gaming_backend/src/api/main.py", "pattern": "/^from . import db as db_module$/", "language": "Python", "kind": "unknown", "nameref": "unknown:db"}, {"_type": "tag", "name": "detail", "path": "/home/kavia/workspace/code-generation/mygov-citizen-engagement-games-platform-217305-217314/gaming_backend/src/api/main.py", "pattern": "/^    detail: str = Field(..., description=\"Additional details about the service.\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "HealthResponse", "scopeKind": "class"}, {"_type": "tag", "name": "get_db_conn", "path": "/home/kavia/workspace/code-generation/mygov-citizen-engagement-games-platform-217305-217314/gaming_backend/src/api/main.py", "pattern": "/^def get_db_conn() -> sqlite3.Connection:$/", "language": "Python", "typeref": "typename:sqlite3.Connection", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "health_check", "path": "/home/kavia/workspace/code-generation/mygov-citizen-engagement-games-platform-217305-217314/gaming_backend/src/api/main.py", "pattern": "/^def health_check(db: sqlite3.Connection = Depends(get_db_conn)) -> HealthResponse:$/", "language": "Python", "typeref": "typename:HealthResponse", "kind": "function", "signature": "(db: sqlite3.Connection = Depends(get_db_conn))"}, {"_type": "tag", "name": "on_shutdown", "path": "/home/kavia/workspace/code-generation/mygov-citizen-engagement-games-platform-217305-217314/gaming_backend/src/api/main.py", "pattern": "/^def on_shutdown() -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "on_startup", "path": "/home/kavia/workspace/code-generation/mygov-citizen-engagement-games-platform-217305-217314/gaming_backend/src/api/main.py", "pattern": "/^def on_startup() -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "service_status", "path": "/home/kavia/workspace/code-generation/mygov-citizen-engagement-games-platform-217305-217314/gaming_backend/src/api/main.py", "pattern": "/^def service_status() -> JSONResponse:$/", "language": "Python", "typeref": "typename:JSONResponse", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "status", "path": "/home/kavia/workspace/code-generation/mygov-citizen-engagement-games-platform-217305-217314/gaming_backend/src/api/main.py", "pattern": "/^    status: str = Field(..., description=\"Overall service status.\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "HealthResponse", "scopeKind": "class"}], "hash": "e4336c3c936b1313ff98d2a471b5bd19", "format-version": 4, "code-base-name": "gaming_backend", "filename": "gaming_backend/src/api/main.py", "fields": [{"name": "Optional[sqlite3.Connection] _db_conn", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "app = FastAPI(", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "str database", "scope": "HealthResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "str detail", "scope": "HealthResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "str status", "scope": "HealthResponse", "scopeKind": "class", "description": "unavailable"}]}