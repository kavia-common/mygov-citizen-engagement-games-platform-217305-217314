{"is_source_file": true, "format": "Python", "description": "This is the main source code file for a FastAPI backend service for the MyGov Citizen Engagement Gaming Platform. It configures the app, including routes for health checks and status, database connection handling, and middleware setup. It also imports route modules for authentication, users, games, leaderboard, and analytics functionalities.", "external_files": ["src/api/routes/auth.py", "src/api/routes/users.py", "src/api/routes/games.py", "src/api/routes/leaderboard.py", "src/api/routes/analytics.py", "src/api/db.py"], "external_methods": ["db_module.create_connection()"], "published": ["health_check", "service_status"], "classes": [{"name": "HealthResponse", "description": "Pydantic model representing the health check response, including overall status, database connectivity status, and additional details."}], "methods": [{"name": "sqlite3.Connection get_db_conn()", "description": "Provides a database connection object or raises HTTP 503 if the database is not initialized.", "scope": "", "scopeKind": ""}, {"name": "None on_startup()", "description": "Initializes the database connection during application startup.", "scope": "", "scopeKind": ""}, {"name": "None on_shutdown()", "description": "Closes the database connection during application shutdown.", "scope": "", "scopeKind": ""}, {"name": "HealthResponse health_check(db: sqlite3.Connection = Depends(get_db_conn))", "description": "Endpoint that performs a health check including database connectivity verification.", "scope": "", "scopeKind": ""}, {"name": "JSONResponse service_status()", "description": "Lightweight endpoint that provides service status without requiring database access.", "scope": "", "scopeKind": ""}], "calls": ["db_module.create_connection()", "HealthResponse(...)", "cur.execute(\"PRAGMA foreign_keys;\")", "cur.execute(\"PRAGMA foreign_keys = ON;\")", "cur.close()", "raise HTTPException(...)", "app.include_router(...)"], "search-terms": ["FastAPI", "Health", "Database Connection", "SQLite", "Main API", "Health Check Endpoint", "Status Endpoint", "Routers"], "state": 2, "file_id": 2, "knowledge_revision": 30, "git_revision": "f75e16e7266fa590076625344bedddd6abf005cf", "revision_history": [{"7": "e100e959f259d21122bf9eb25506196ece8c2bf0"}, {"12": "e100e959f259d21122bf9eb25506196ece8c2bf0"}, {"13": "e100e959f259d21122bf9eb25506196ece8c2bf0"}, {"14": "e100e959f259d21122bf9eb25506196ece8c2bf0"}, {"15": "57177fa216712bb08275bed0c7bf5c25bb0bad4a"}, {"22": "ead6510d46b957004c345f43de9c69c9c0a6d401"}, {"26": "cd0dc9336d4ce838a7bfb4872116d8553d791a9a"}, {"30": "f75e16e7266fa590076625344bedddd6abf005cf"}], "ctags": [{"_type": "tag", "name": "HealthResponse", "path": "/home/kavia/workspace/code-generation/mygov-citizen-engagement-games-platform-217305-217314/gaming_backend/src/api/main.py", "pattern": "/^class HealthResponse(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "_db_conn", "path": "/home/kavia/workspace/code-generation/mygov-citizen-engagement-games-platform-217305-217314/gaming_backend/src/api/main.py", "pattern": "/^_db_conn: Optional[sqlite3.Connection] = None$/", "language": "Python", "typeref": "typename:Optional[sqlite3.Connection]", "kind": "variable"}, {"_type": "tag", "name": "analytics_router", "path": "/home/kavia/workspace/code-generation/mygov-citizen-engagement-games-platform-217305-217314/gaming_backend/src/api/main.py", "pattern": "/^from src.api.routes.analytics import router as analytics_router  # noqa: E402$/", "language": "Python", "kind": "unknown", "nameref": "unknown:router"}, {"_type": "tag", "name": "app", "path": "/home/kavia/workspace/code-generation/mygov-citizen-engagement-games-platform-217305-217314/gaming_backend/src/api/main.py", "pattern": "/^app = FastAPI($/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "auth_router", "path": "/home/kavia/workspace/code-generation/mygov-citizen-engagement-games-platform-217305-217314/gaming_backend/src/api/main.py", "pattern": "/^from src.api.routes.auth import router as auth_router  # noqa: E402$/", "language": "Python", "kind": "unknown", "nameref": "unknown:router"}, {"_type": "tag", "name": "database", "path": "/home/kavia/workspace/code-generation/mygov-citizen-engagement-games-platform-217305-217314/gaming_backend/src/api/main.py", "pattern": "/^    database: str = Field(..., description=\"Database connectivity status.\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "HealthResponse", "scopeKind": "class"}, {"_type": "tag", "name": "db_module", "path": "/home/kavia/workspace/code-generation/mygov-citizen-engagement-games-platform-217305-217314/gaming_backend/src/api/main.py", "pattern": "/^from . import db as db_module$/", "language": "Python", "kind": "unknown", "nameref": "unknown:db"}, {"_type": "tag", "name": "detail", "path": "/home/kavia/workspace/code-generation/mygov-citizen-engagement-games-platform-217305-217314/gaming_backend/src/api/main.py", "pattern": "/^    detail: str = Field(..., description=\"Additional details about the service.\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "HealthResponse", "scopeKind": "class"}, {"_type": "tag", "name": "games_router", "path": "/home/kavia/workspace/code-generation/mygov-citizen-engagement-games-platform-217305-217314/gaming_backend/src/api/main.py", "pattern": "/^from src.api.routes.games import router as games_router  # noqa: E402$/", "language": "Python", "kind": "unknown", "nameref": "unknown:router"}, {"_type": "tag", "name": "get_db_conn", "path": "/home/kavia/workspace/code-generation/mygov-citizen-engagement-games-platform-217305-217314/gaming_backend/src/api/main.py", "pattern": "/^def get_db_conn() -> sqlite3.Connection:$/", "language": "Python", "typeref": "typename:sqlite3.Connection", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "health_check", "path": "/home/kavia/workspace/code-generation/mygov-citizen-engagement-games-platform-217305-217314/gaming_backend/src/api/main.py", "pattern": "/^def health_check(db: sqlite3.Connection = Depends(get_db_conn)) -> HealthResponse:$/", "language": "Python", "typeref": "typename:HealthResponse", "kind": "function", "signature": "(db: sqlite3.Connection = Depends(get_db_conn))"}, {"_type": "tag", "name": "leaderboard_router", "path": "/home/kavia/workspace/code-generation/mygov-citizen-engagement-games-platform-217305-217314/gaming_backend/src/api/main.py", "pattern": "/^from src.api.routes.leaderboard import router as leaderboard_router  # noqa: E402$/", "language": "Python", "kind": "unknown", "nameref": "unknown:router"}, {"_type": "tag", "name": "on_shutdown", "path": "/home/kavia/workspace/code-generation/mygov-citizen-engagement-games-platform-217305-217314/gaming_backend/src/api/main.py", "pattern": "/^def on_shutdown() -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "on_startup", "path": "/home/kavia/workspace/code-generation/mygov-citizen-engagement-games-platform-217305-217314/gaming_backend/src/api/main.py", "pattern": "/^def on_startup() -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "service_status", "path": "/home/kavia/workspace/code-generation/mygov-citizen-engagement-games-platform-217305-217314/gaming_backend/src/api/main.py", "pattern": "/^def service_status() -> JSONResponse:$/", "language": "Python", "typeref": "typename:JSONResponse", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "status", "path": "/home/kavia/workspace/code-generation/mygov-citizen-engagement-games-platform-217305-217314/gaming_backend/src/api/main.py", "pattern": "/^    status: str = Field(..., description=\"Overall service status.\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "HealthResponse", "scopeKind": "class"}, {"_type": "tag", "name": "users_router", "path": "/home/kavia/workspace/code-generation/mygov-citizen-engagement-games-platform-217305-217314/gaming_backend/src/api/main.py", "pattern": "/^from src.api.routes.users import router as users_router  # noqa: E402$/", "language": "Python", "kind": "unknown", "nameref": "unknown:router"}], "hash": "bec54b29808f52ca32389eb89fbc4238", "format-version": 4, "code-base-name": "gaming_backend", "filename": "gaming_backend/src/api/main.py", "fields": [{"name": "Optional[sqlite3.Connection] _db_conn", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "app = FastAPI(", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "str database", "scope": "HealthResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "str detail", "scope": "HealthResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "str status", "scope": "HealthResponse", "scopeKind": "class", "description": "unavailable"}]}